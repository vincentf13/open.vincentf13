spring:
  datasource:
    dynamic:
      primary: db0
      strict: false
      lazy: true
      strategy: com.baomidou.dynamic.datasource.strategy.LoadBalanceDynamicDataSourceStrategy
      datasource:
        # === db0 master/slave ===
        db0-master:
          url: jdbc:mysql://infra-mysql-0.infra-mysql-headless:3306/app?characterEncoding=utf8mb4&serverTimezone=UTC&connectTimeout=3000&socketTimeout=15000&tcpKeepAlive=true&rewriteBatchedStatements=true&allowMultiQueries=true&cachePrepStmts=true&prepStmtCacheSize=256&prepStmtCacheSqlLimit=2048&useServerPrepStmts=true&cacheResultSetMetadata=true&cacheServerConfiguration=true&useLocalSessionState=true
          username: ${MYSQL_USERNAME:root}
          password: ${MYSQL_PASSWORD:root}
          driver-class-name: com.mysql.cj.jdbc.Driver
          hikari:
            max-lifetime: 1700000
            idle-timeout: 600000
            maximum-pool-size: 16
            minimum-idle: 2
            connection-timeout: 30000
            validation-timeout: 5000
        db0-slave:
          url: jdbc:mysql://infra-mysql-0.infra-mysql-headless:3306/app?characterEncoding=utf8mb4&serverTimezone=UTC&connectTimeout=3000&socketTimeout=15000&tcpKeepAlive=true&rewriteBatchedStatements=true&allowMultiQueries=true&cachePrepStmts=true&prepStmtCacheSize=256&prepStmtCacheSqlLimit=2048&useServerPrepStmts=true&cacheResultSetMetadata=true&cacheServerConfiguration=true&useLocalSessionState=true
          username: ${MYSQL_USERNAME:root}
          password: ${MYSQL_PASSWORD:root}
          driver-class-name: com.mysql.cj.jdbc.Driver
          hikari:
            max-lifetime: 1700000
            idle-timeout: 600000
            maximum-pool-size: 12
            minimum-idle: 2
            connection-timeout: 30000
            validation-timeout: 5000
        # === db1 master/slave ===
        db1-master:
          url: jdbc:mysql://infra-mysql-1.infra-mysql-headless:3306/app?characterEncoding=utf8mb4&serverTimezone=UTC&connectTimeout=3000&socketTimeout=15000&tcpKeepAlive=true&rewriteBatchedStatements=true&allowMultiQueries=true&cachePrepStmts=true&prepStmtCacheSize=256&prepStmtCacheSqlLimit=2048&useServerPrepStmts=true&cacheResultSetMetadata=true&cacheServerConfiguration=true&useLocalSessionState=true
          username: ${MYSQL_USERNAME:root}
          password: ${MYSQL_PASSWORD:root}
          driver-class-name: com.mysql.cj.jdbc.Driver
          hikari:
            max-lifetime: 1700000
            idle-timeout: 600000
            maximum-pool-size: 16
            minimum-idle: 2
            connection-timeout: 30000
            validation-timeout: 5000
        db1-slave:
          url: jdbc:mysql://infra-mysql-1.infra-mysql-headless:3306/app?characterEncoding=utf8mb4&serverTimezone=UTC&connectTimeout=3000&socketTimeout=15000&tcpKeepAlive=true&rewriteBatchedStatements=true&allowMultiQueries=true&cachePrepStmts=true&prepStmtCacheSize=256&prepStmtCacheSqlLimit=2048&useServerPrepStmts=true&cacheResultSetMetadata=true&cacheServerConfiguration=true&useLocalSessionState=true
          username: ${MYSQL_USERNAME:root}
          password: ${MYSQL_PASSWORD:root}
          driver-class-name: com.mysql.cj.jdbc.Driver
          hikari:
            max-lifetime: 1700000
            idle-timeout: 600000
            maximum-pool-size: 12
            minimum-idle: 2
            connection-timeout: 30000
            validation-timeout: 5000
      group:
        db0:
          primary: db0-master
          replicas:
            - db0-slave
        db1:
          primary: db1-master
          replicas:
            - db1-slave

logging:
  level:
    org.mybatis: warn

mybatis:
  mapper-locations: classpath*:mapper/**/*.xml
  type-aliases-package: com.example.app.model
  configuration:
    map-underscore-to-camel-case: true
    cache-enabled: false
    default-statement-timeout: 30
    jdbc-type-for-null: NULL
    local-cache-scope: STATEMENT
    lazy-loading-enabled: false
    aggressive-lazy-loading: false
    default-executor-type: REUSE
    log-impl: org.apache.ibatis.logging.log4j2.Log4j2Impl
    use-generated-keys: true
    default-fetch-size: 200
    call-setters-on-nulls: true

pagehelper:
  helper-dialect: mysql
  reasonable: true
  support-methods-arguments: false
  params: count=countSql
  row-bounds-with-count: true
